---
title: "Poročilo pri predmetu Analiza podatkov s programom R"
author: "Tomas Rode"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
---

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
# Če želimo nastaviti pisave v PDF-ju, odkomentiramo
# in sledimo navodilom v programu.
#source("fontconfig.r", encoding="UTF-8")

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding="UTF-8")
```

```{r rstudio, echo=FALSE, results='asis', warning=FALSE}
# Izris povezave do RStudia na Binderju
source("lib/rstudio.r", encoding="UTF-8")
```

# Tema: Izobraževanje v državah OECD

Analiziral bom podatke o izobraževanju za države OECD. Za merilo uspešnosti izobraževanja bom, ker gre za države z visoko stopnjo pismenosti, uporabil rezultate testov PISA, ki merijo usprešnost 15-letnikov na treh področjih -- matematika, znanost in branje. Primerjal bom uspešnost držav na teh testih glede na: BDP PPP, število let obveznega šolanja, razmerje med številoma učencev in učiteljev (za osnovne in srednje šole), državno porabo za izobraževanje v % BDP, sredstva namenjena osebju v izobraževanju v % potrošnje v javnih ustanovah.


***

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE, message=FALSE, warning=FALSE}
source("uvoz/uvoz.r", encoding="UTF-8")
```

Uvozil sem podatke o občinah v obliki CSV z OECD podatkovne baze.
Podatke imamo v osmih razpredelnicah v obliki *tidy data*.

1. `PISA` - podatki o rezultatih PISA po državah
  - `LOCATION` - spremenljivka: kratice opazovanih držav, (neurejen faktor)
  - `INDICATOR` - spremenljivka: predmet testiranja (PISAMATH, PISASCIENCE, PISAREADING), (neurejen faktor) 
  - `SUBJECT` - spremelnjivka: nabor testirancev (BOY, GIRL, TOT -- fantje, dekleta, vsi), (neurejen faktor)
  - `TIME` - spremenljivka: leto testiranja, (število)
  - `Value`- meritev: vrednost indeksa PISA, (število)
  
2. `ImenaDrzav` - Imena držav in njihove kratice
  - `ime.drzave` - spremenljivka: imena držav, (neurejen faktor)
  - `LOCATION` - meritev: kratice opazovanih držav, (neurejen faktor)

3. `BDPpc` - podatki o BDP per capita po državah
  - `LOCATION` - spremenljivka: kratice opazovanih držav, (neurejen faktor)
  - `TIME` - spremenljivka: leto meritve, (število)
  - `BDPpc`- meritev: BDP per capita v stalnih cenah (ref. leto 2010), (število)
  
4. `ObveznoSol` - podatki o obveznih letih šolanja po državah
  - `LOCATION` - spremenljivka: kratice opazovanih držav, (neurejen faktor)
  - `TIME` - spremenljivka: leto meritve, (število)
  - `ObveznaLeta`- meritev: vrednost indeksa PISA, (število)

5. `RazmerjeOS` - podatki razmerju med učenci in učitelji na OŠ po državah
  - `LOCATION` - spremenljivka: kratice opazovanih držav, (neurejen faktor)
  - `TIME` - spremenljivka: leto meritve, (število)
  - `RazmerjeUUOS`- meritev: razmerje med učitelji in učenci v OŠ, (število)
  
6. `RazmerjeSS` - podatki razmerju med učenci in učitelji na SŠ po državah
  - `LOCATION` - spremenljivka: kratice opazovanih držav, (neurejen faktor)
  - `TIME` - spremenljivka: leto meritve, (število)
  - `RazmerjeUUSS`- meritev: razmerje med učitelji in učenci v SŠ, (število)
  
7. `ZaOsebje` - podatki o potrošnji za osebje v izobraževanju po državah
  - `LOCATION` - spremenljivka: kratice opazovanih držav, (neurejen faktor)
  - `TIME` - spremenljivka: leto meritve, (število)
  - `PotrosnjaZaOsebje`- meritev: potrošnja za osebje v izobraževanju (v % celotne potrošnje države v javnih ustanovah), (število)
  
8. `ZaIzob` - podatki o državni potrošnji za izobraevaževanje po državah
  - `LOCATION` - spremenljivka: kratice opazovanih držav, (neurejen faktor)
  - `TIME` - spremenljivka: leto meritve, (število)
  - `PotrosnjaZaIzob`- meritev: potrošnja države za izobraževanje (v % BDP), (število).


Spodnji graf prikazuje povprecje rezultatov PISAMATH, PISAREADING in PISASCIENCE po državah v letu 2015.


```{r graf1, echo=FALSE, message=FALSE, fig.align='center', fig.cap='Graf indeksa PISA po državah v letu 2015', warning=FALSE}
PISA.2015 <- PISA %>% filter(SUBJECT=='TOT' & TIME==2015) %>% 
                  group_by(LOCATION) %>% summarise(POVPRECJE=mean(Value))
barve <- ifelse(PISA.2015$LOCATION=='SVN', 'JE', 'NI')
ggplot(PISA.2015, aes(x= reorder(LOCATION, POVPRECJE),y=POVPRECJE, fill = barve)) +
                  geom_col(show.legend = FALSE) + 
                  ggtitle("Povprečje treh indeksov PISA v letu 2015 po državah") + 
                  xlab("Države") + ylab("Povprečje") + 
                  theme(axis.text.x=element_text(angle=90, hjust=1, vjust=0.5))
```

***

# Analiza in vizualizacija podatkov

```{r vizualizacija, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
source("vizualizacija/vizualizacija.r", encoding="UTF-8")
```

Spodnji zemljevid prikazuje povprečje indeksa PISA med letoma 2003 in 2015 po državah. Na zemljevidu zaradi neobičajnega mednarodnopravnega statusa ne najdemo Hong-Konga, Singapurja in Macaa.

```{r zemljevid, echo=FALSE, fig.align='center', fig.cap='Zemljevid povprečja indeksa PISA med letoma 2003 in 2015', warning=FALSE}
Pzemljevid
```

Spodnji graf prikazuje odnos med BDP per capita in uspehom učencev na testiranjih. Vidimo lahko, da je povezava močna predvsem pri manj razvitih državah, ki praviloma dosegajo slabše rezultate od bolje razvitih držav. Pri državah z BDP per capita višjim od 20.000 USD (za predstavo - Slovenija ima okoli 23.500 USD), pa BDP per capita ne igra tako poglavitne vloge.

```{r graf2, echo=FALSE, fig.align='center', fig.cap='Graf povprečja indeksov PISA po BDP per capita', warning=FALSE}
PISAbdppc
```

Na naslednjem grafu lahko opazimo nov dejavnik, ki vpliva na uspešnost učencev pri testiranjih. Kot pričakovano, so učenci v državah, kjer so učni razredi manjši, praviloma dosegali boljše rezultate. Zdi se torej, da je individualni pristop k posredovanju znanja uspešnejši. Ob tem velja poudariti, da je velikost razredov le eden od dejavnikov, ki vplivajo na uspešnost učencev, zato korelacija ostaja šibka (-0.36). Hkrati je iz podatkov možno sklepati, da povezava med tema spremenljivkama obstaja.

```{r graf3, echo=FALSE, fig.align='center', fig.cap='Graf povprečja indeksov PISA po razmerju med učenci in učitelji', warning=FALSE}
PISArazo
```

Do zanimivih zaključkov lahko pridemo, ko primerjamo rezulate PISA med spoloma. Kot prikazuje spodnji graf dekleta v skoraj vseh državah dosegajo boljše rezultate od dečkov. 

```{r graf4, echo=FALSE, fig.align='center', fig.cap='Graf razlike indeksov PISA med spoloma po državah', warning=FALSE}
PISArazlika
```

Če smo pozorni lahko opazimo, da so države, kjer so razike velike, tiste, ki so celokupno uspešejše na testiranjih, tiste, kjer so razlike manjše pa praviloma dosegajo slabše razultate. Povezavo med povprečno razliko med spoloma in povprečjem indeksov PISA prikazuje spodnji graf.

```{r graf5, echo=FALSE, fig.align='center', fig.cap='Graf povprečja indeksov PISA po povprečni razliki med rezultati deklet in dečkov', warning=FALSE}
PISAdekletavspovp
```

Iz tega grafa bi lahko sklepali, da so dekleta pri testiranjih bolj uspešna od dečkov in da se razlika med spoloma pri bolj optimalnih pogojih samo še povečuje.

***